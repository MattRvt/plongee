drop table if exists PLO_CONCERNER;
drop table if exists PLO_PALANQUEE;
drop table if exists PLO_PLONGEE;
drop table if exists PLO_DIRECTEUR;
drop table if exists PLO_SECURITE_DE_SURFACE;
drop table if exists PLO_PLONGEUR;
drop table if exists PLO_SITE;
drop table if exists PLO_EMBARCATION;
drop table if exists PLO_PERSONNE;
drop table if exists PLO_APTITUDE;

CREATE TABLE PLO_DIRECTEUR
 (
   PER_NUM SMALLINT NOT NULL  
   , PRIMARY KEY (PER_NUM) 
 );

CREATE TABLE PLO_PERSONNE
 (
   PER_NUM SMALLINT NOT NULL ,
   PER_NOM VARCHAR(30) NULL  ,
   PER_PRENOM VARCHAR(30) NULL  ,
   PER_ACTIVE BOOL NULL  ,
   PER_DATE_CERTIF_MED DATE NULL  
   , PRIMARY KEY (PER_NUM) 
 ); 

CREATE TABLE PLO_APTITUDE
 (
   APT_CODE CHAR(5) NOT NULL  ,
   APT_LIBELLE VARCHAR(100) NULL  
   , PRIMARY KEY (APT_CODE) 
 ); 

CREATE TABLE PLO_EMBARCATION
 (
   EMB_NUM CHAR(32) NOT NULL  ,
   EMB_NOM VARCHAR(64) NULL  
   , PRIMARY KEY (EMB_NUM) 
 ); 

CREATE TABLE PLO_PLONGEUR
 (
   PER_NUM SMALLINT NOT NULL  ,
   APT_CODE CHAR(5) NOT NULL  
   , PRIMARY KEY (PER_NUM) 
 ); 

CREATE INDEX I_FK_PLO_PLONGEUR_PLO_APTITUDE
     ON PLO_PLONGEUR (APT_CODE ASC);

CREATE TABLE PLO_SECURITE_DE_SURFACE
 (
   PER_NUM SMALLINT NOT NULL  
   , PRIMARY KEY (PER_NUM) 
 ); 

CREATE TABLE PLO_PALANQUEE
 (
   PLO_DATE DATE NOT NULL  ,
   PLO_MAT_MID_SOI CHAR(1) NOT NULL  ,
   PAL_NUM INTEGER NOT NULL  ,
   PAL_PROFONDEUR_MAX REAL(6,2) NULL  ,
   PAL_DUREE_MAX INTEGER NULL  ,
   PAL_HEURE_IMMERSION TIME NULL  ,
   PAL_HEURE_SORTIE_EAU TIME NULL  ,
   PAL_PROFONDEUR_REELLE INTEGER NULL  ,
   PAL_DUREE_FOND INTEGER NULL  
   , PRIMARY KEY (PLO_DATE,PLO_MAT_MID_SOI,PAL_NUM) 
 );

CREATE  INDEX I_FK_PLO_PALANQUEE_PLO_PLONGEE
     ON PLO_PALANQUEE (PLO_DATE ASC,PLO_MAT_MID_SOI ASC);

CREATE TABLE PLO_PLONGEE
 (
   PLO_DATE DATE NOT NULL  ,
   PLO_MAT_MID_SOI CHAR(1) NOT NULL  ,
   SIT_NUM INTEGER NOT NULL  ,
   EMB_NUM CHAR(32) NOT NULL  ,
   PER_NUM_DIR SMALLINT NOT NULL  ,
   PER_NUM_SECU SMALLINT NOT NULL  ,
   PLO_EFFECTIF_PLONGEURS INTEGER NULL  ,
   PLO_EFFECTIF_BATEAU INTEGER NULL  ,
   PLO_NB_PALANQUEES INTEGER NULL  ,
   PLO_ETAT VARCHAR(16) NULL  
   , PRIMARY KEY (PLO_DATE,PLO_MAT_MID_SOI) 
 ); 


CREATE INDEX I_FK_PLO_PLONGEE_PLO_DIRECTEUR ON PLO_PLONGEE (PER_NUM_DIR ASC);

CREATE INDEX I_FK_PLO_PLONGEE_PLO_SITE ON PLO_PLONGEE (SIT_NUM ASC);

CREATE INDEX I_FK_PLO_PLONGEE_PLO_SECURITE_DE_SURFACE ON PLO_PLONGEE (PER_NUM_SECU ASC);

CREATE INDEX I_FK_PLO_PLONGEE_PLO_EMBARCATION ON PLO_PLONGEE (EMB_NUM ASC);

CREATE TABLE PLO_SITE
 (
   SIT_NUM INTEGER NOT NULL  ,
   SIT_NOM VARCHAR(128) NULL  ,
   SIT_LOCALISATION VARCHAR(64) NULL  
   , PRIMARY KEY (SIT_NUM) 
 ); 

CREATE TABLE PLO_CONCERNER
 (
   PLO_DATE DATE NOT NULL  ,
   PLO_MAT_MID_SOI CHAR(1) NOT NULL  ,
   PAL_NUM INTEGER NOT NULL  ,
   PER_NUM SMALLINT NOT NULL  
   , PRIMARY KEY (PLO_DATE,PLO_MAT_MID_SOI,PAL_NUM,PER_NUM) 
 ); 


CREATE INDEX I_FK_PLO_CONCERNER_PLO_PALANQUEE ON PLO_CONCERNER (PLO_DATE ASC,PLO_MAT_MID_SOI ASC,PAL_NUM ASC);

CREATE INDEX I_FK_PLO_CONCERNER_PLO_PLONGEUR ON PLO_CONCERNER (PER_NUM ASC);


ALTER TABLE PLO_DIRECTEUR 
  ADD FOREIGN KEY FK_PLO_DIRECTEUR_PLO_PERSONNE (PER_NUM)
      REFERENCES PLO_PERSONNE (PER_NUM) ;


ALTER TABLE PLO_PLONGEUR 
  ADD FOREIGN KEY FK_PLO_PLONGEUR_PLO_APTITUDE (APT_CODE)
      REFERENCES PLO_APTITUDE (APT_CODE) ;


ALTER TABLE PLO_PLONGEUR 
  ADD FOREIGN KEY FK_PLO_PLONGEUR_PLO_PERSONNE (PER_NUM)
      REFERENCES PLO_PERSONNE (PER_NUM) ;


ALTER TABLE PLO_SECURITE_DE_SURFACE 
  ADD FOREIGN KEY FK_PLO_SECURITE_DE_SURFACE_PLO_PERSONNE (PER_NUM)
      REFERENCES PLO_PERSONNE (PER_NUM) ;


ALTER TABLE PLO_PALANQUEE 
  ADD FOREIGN KEY FK_PLO_PALANQUEE_PLO_PLONGEE (PLO_DATE,PLO_MAT_MID_SOI)
      REFERENCES PLO_PLONGEE (PLO_DATE,PLO_MAT_MID_SOI) ;


ALTER TABLE PLO_PLONGEE 
  ADD FOREIGN KEY FK_PLO_PLONGEE_PLO_DIRECTEUR (PER_NUM_DIR)
      REFERENCES PLO_DIRECTEUR (PER_NUM) ;


ALTER TABLE PLO_PLONGEE 
  ADD FOREIGN KEY FK_PLO_PLONGEE_PLO_SITE (SIT_NUM)
      REFERENCES PLO_SITE (SIT_NUM) ;


ALTER TABLE PLO_PLONGEE 
  ADD FOREIGN KEY FK_PLO_PLONGEE_PLO_SECURITE_DE_SURFACE (PER_NUM_SECU)
      REFERENCES PLO_SECURITE_DE_SURFACE (PER_NUM) ;


ALTER TABLE PLO_PLONGEE 
  ADD FOREIGN KEY FK_PLO_PLONGEE_PLO_EMBARCATION (EMB_NUM)
      REFERENCES PLO_EMBARCATION (EMB_NUM) ;


ALTER TABLE PLO_CONCERNER 
  ADD FOREIGN KEY FK_PLO_CONCERNER_PLO_PALANQUEE (PLO_DATE,PLO_MAT_MID_SOI,PAL_NUM)
      REFERENCES PLO_PALANQUEE (PLO_DATE,PLO_MAT_MID_SOI,PAL_NUM) ;


ALTER TABLE PLO_CONCERNER 
  ADD FOREIGN KEY FK_PLO_CONCERNER_PLO_PLONGEUR (PER_NUM)
      REFERENCES PLO_PLONGEUR (PER_NUM) ;

INSERT INTO `PLO_PERSONNE`(`PER_NUM`, `PER_NOM`, `PER_PRENOM`, `PER_ACTIVE`, `PER_DATE_CERTIF_MED`) VALUES (1,'Audabram','Luc',1,STR_TO_DATE('21/5/2013','%d/%m/%Y'));

INSERT INTO `PLO_DIRECTEUR`(`PER_NUM`) VALUES (1);

INSERT INTO `PLO_SECURITE_DE_SURFACE`(`PER_NUM`) VALUES (1);

INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('B', 'Bapt�me');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PPB', 'pr�paration plongeur Bronze');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PPA', 'pr�paration plongeur Argent');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PN1', 'pr�paration plongeur Niveau1');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PN2', 'pr�paration plongeur Niveau 2');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PN3', 'pr�paration plongeur Niveau 3');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PN4', 'pr�paration plongeur Niveau 4');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PE-6', 'plongeur encadr� jusqu�� 6 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PE-12', 'plongeur encadr� jusqu�� 12 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PE-20', 'plongeur encadr� jusqu�� 20 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PE-40', 'plongeur encadr� jusqu�� 40 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PA-20', 'plongeur autonome jusqu�� 20 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PA-40', 'plongeur autonome jusqu�� 40 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('PA-60', 'plongeur autonome jusqu�� 60 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('E1', 'encadrant jusqu�� 6 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('E2', 'encadrant jusqu�� 40 m.');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('E3', 'encadrant moniteur f�d�ral 1');
INSERT INTO `PLO_APTITUDE` (`APT_CODE`,`APT_LIBELLE`)  VALUES ('E4', 'encadrant moniteur f�d�ral 2');

INSERT INTO `PLO_PERSONNE`( `PER_NUM`,`PER_NOM`, `PER_PRENOM`) VALUES (0,"Audabram","Luc");
INSERT INTO `PLO_PERSONNE`( `PER_NUM`,`PER_NOM`, `PER_PRENOM`) VALUES (1,"Rivat","Matthis");
INSERT INTO `PLO_PERSONNE`( `PER_NUM`,`PER_NOM`, `PER_PRENOM`) VALUES (2,"Chavas","Nathan");
INSERT INTO `PLO_PERSONNE`( `PER_NUM`,`PER_NOM`, `PER_PRENOM`) VALUES (3,"Simonin","Melissande");
INSERT INTO `PLO_PERSONNE`( `PER_NUM`,`PER_NOM`, `PER_PRENOM`) VALUES (4,"Geumeunoix","Khaled");

INSERT INTO `plo_plongeur`(`PER_NUM`,`APT_CODE`) VALUES (3,"B");
INSERT INTO `plo_plongeur`(`PER_NUM`,`APT_CODE`) VALUES (4,"E4");
INSERT INTO `plo_plongeur`(`PER_NUM`,`APT_CODE`) VALUES (5,"PPB");

INSERT INTO `plo_securite_de_surface`(`PER_NUM`) VALUES (1);

INSERT INTO `plo_directeur`(`PER_NUM`) VALUES (2);





INSERT INTO `PLO_DIRECTEUR`(`PER_NUM`) VALUES (1);

INSERT INTO `PLO_SECURITE_DE_SURFACE`(`PER_NUM`) VALUES (2);